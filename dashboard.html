<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Sistema AURA ğŸ’œ - Dashboard</title>
  <link rel="icon" href="Aurinha.png" />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css" />

  <style>
    /* --- Sidebar nav pill style (mantendo o mesmo roxo) --- */
    .sidebar ul li .navlink {
      display: flex;
      align-items: center;
      gap: 10px;
      text-decoration: none;
      color: rgba(255, 255, 255, 0.9);
      font-weight: 600;
      padding: 0.6rem 0.9rem;
      border-radius: 14px;
      transition: transform 0.12s ease, box-shadow 0.2s ease, background 0.2s ease, color 0.2s ease;
    }

    .sidebar ul li .navlink .icon {
      width: 1.4rem;
      text-align: center;
      filter: drop-shadow(0 0 6px rgba(180, 107, 255, 0.25));
    }

    .sidebar ul li .navlink:hover {
      transform: translateX(3px);
      background: rgba(180, 107, 255, 0.12);
      box-shadow: 0 8px 18px rgba(180, 107, 255, 0.18);
    }

    .sidebar ul li .navlink.active {
      background: rgba(180, 107, 255, 0.18);
      box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.06),
                  0 10px 24px rgba(180, 107, 255, 0.22);
    }

    /* --- DASHBOARD CARDS MAIORES --- */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(230px, 1fr)); /* cards mais largos */
      gap: 1.4rem;
      margin-top: 1.5rem;
    }

    .stat-card {
      padding: 1.4rem 1.6rem;              /* mais padding */
      min-height: 150px;                   /* mais altura */
      border-radius: 18px;                 /* cantos mais suaves */
      cursor: pointer;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      box-shadow: 0 10px 24px rgba(180, 107, 255, 0.18);
      transition: transform 0.16s ease, box-shadow 0.2s ease;
    }

    .stat-card h3 {
      font-size: 1rem;
      margin: 0 0 .4rem;
      opacity: .9;
    }

    .stat-card p {
      margin: 0;
      font-size: 2.4rem;          /* nÃºmero maior */
      font-weight: 700;
      line-height: 1.1;
    }

    .stat-card:hover {
      transform: translateY(-3px);
      box-shadow: 0 14px 30px rgba(180, 107, 255, 0.28);
    }
  </style>
</head>

<body>
  <!-- MENU LATERAL -->
  <div class="sidebar">
    <h2 class="logo">SISTEMA AURA</h2>
    <span id="agentNameDisplay" class="agent-display">Agente: -</span>

    <ul>
      <li><a href="dashboard.html" class="navlink active"><span class="icon">ğŸ </span><span class="label">Dashboard</span></a></li>
      <li><a href="pesquisa/ver.html" class="navlink"><span class="icon">ğŸ”</span><span class="label">Pesquisa Geral</span></a></li>
      <li><a href="perfis/ver.html" class="navlink"><span class="icon">ğŸ‘‘</span><span class="label">Perfil da Aura</span></a></li>
      <li><a href="people/ver.html" class="navlink"><span class="icon">ğŸ§</span><span class="label">Pessoas</span></a></li>
      <li><a href="casos/ver.html" class="navlink"><span class="icon">ğŸ“</span><span class="label">Casos</span></a></li>
      <li><a href="investigacoes/ver.html" class="navlink"><span class="icon">ğŸ•µï¸</span><span class="label">InvestigaÃ§Ãµes</span></a></li>
      <li><a href="veiculos/ver.html" class="navlink"><span class="icon">ğŸï¸</span><span class="label">VeÃ­culos</span></a></li>
      <li><a href="facc/ver.html" class="navlink"><span class="icon">âš”ï¸</span><span class="label">FacÃ§Ãµes</span></a></li>
      <li><a href="perimetro/ver.html" class="navlink"><span class="icon">ğŸ“</span><span class="label">PerÃ­metro de AÃ§Ãµes</span></a></li>
      <li><a href="reunioes/ver.html" class="navlink"><span class="icon">ğŸ—“ï¸</span><span class="label">ReuniÃµes</span></a></li>
      <li><a href="regras/ver.html" class="navlink active"><span class="icon">ğŸ“š</span><span class="label">Regras CDA</span></a></li>
    </ul>

    <button id="logoutBtn">Sair</button>
  </div>

  <!-- CONTEÃšDO PRINCIPAL -->
  <div class="main-content">
    <header>
      <h1>VisÃ£o Geral</h1>
      <input type="text" id="searchInput" placeholder="Pesquisar no sistema...">
    </header>

    <section class="stats-grid">
      <div class="stat-card" id="cardPeople">
        <h3>Pessoas</h3>
        <p id="countPeople">0</p>
      </div>
      <div class="stat-card" id="cardCases">
        <h3>Casos</h3>
        <p id="countCases">0</p>
      </div>
      <div class="stat-card" id="cardInvestigations">
        <h3>InvestigaÃ§Ãµes</h3>
        <p id="countInvestigations">0</p>
      </div>
      <div class="stat-card" id="cardFacc">
        <h3>FacÃ§Ãµes</h3>
        <p id="countFacc">0</p>
      </div>
    </section>

  <script type="module">
    import { initializeApp, getApps } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-app.js";
    import { getFirestore, collection, getDocs } 
      from "https://www.gstatic.com/firebasejs/10.13.1/firebase-firestore.js";
    import { firebaseConfig } from "./firebaseConfig.js";

    const app = getApps().length === 0 ? initializeApp(firebaseConfig) : getApps()[0];
    const db = getFirestore(app);

    // Exibir o nome do agente logado
    const agent = localStorage.getItem("selectedAgent") || "Desconhecido";
    document.getElementById("agentNameDisplay").textContent = `Agente: ${agent}`;

    // Contadores
    async function updateCounts() {
      const collections = [
        { name: "people", elem: "countPeople" },
        { name: "cases", elem: "countCases" },
        { name: "investigacoes", elem: "countInvestigations" },
        { name: "facc", elem: "countFacc" },
      ];

      for (const c of collections) {
        const snap = await getDocs(collection(db, c.name));
        document.getElementById(c.elem).textContent = snap.size;
      }
    }

    // Tornar os cartÃµes clicÃ¡veis
    document.getElementById("cardPeople").addEventListener("click", () => window.location.href = "people/ver.html");
    document.getElementById("cardCases").addEventListener("click", () => window.location.href = "casos/ver.html");
    document.getElementById("cardInvestigations").addEventListener("click", () => window.location.href = "investigacoes/ver.html");
    document.getElementById("cardFacc").addEventListener("click", () => window.location.href = "facc/ver.html");

    // BotÃ£o Sair
    const logoutBtn = document.getElementById("logoutBtn");
    if (logoutBtn) {
      logoutBtn.addEventListener("click", () => {
        const keys = ["username","selectedAgent","userRole","userCode","isAdmin"];
        keys.forEach(k => localStorage.removeItem(k));
        window.location.href = "select.html";
      });
    }

    updateCounts();
    // loadLogs(); // se tiveres esta funÃ§Ã£o noutro ficheiro, podes voltar a chamar
  </script>
</body>
</html>
